services:
  whatsapp-bot:
    build: .
    container_name: whatsapp-bot
    restart: always

    # ðŸ”¥ INTERACTIVO ACTIVADO (NO SE QUITA)
    tty: true
    stdin_open: true

    env_file:
      - .env

    volumes:
      - whatsapp_sessions:/usr/src/app/Sessions
      - ./logs:/usr/src/app/logs

    expose:
      - "3001"

    command: node index.js

  admin-panel:
    build: ./frontend-next
    container_name: admin-panel
    restart: always

    tty: true
    stdin_open: true

    env_file:
      - .env

    expose:
      - "3000"

    command: npm start

  nginx:
    image: nginx:alpine
    container_name: konmi-nginx
    restart: always

    ports:
      - "80:80"
      - "443:443"

    volumes:
      - ./nginx/default.conf:/etc/nginx/conf.d/default.conf:ro
      - /etc/letsencrypt:/etc/letsencrypt:ro
      - /var/lib/letsencrypt:/var/lib/letsencrypt:ro

    depends_on:
      - whatsapp-bot
      - admin-panel

volumes:
  whatsapp_sessions:

